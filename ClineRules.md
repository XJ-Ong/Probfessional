# Cline Rules for ASP.NET Web Development (Visual Studio)

These Cline rules define the **standardized coding practices, patterns, and frameworks** for ASP.NET Web Forms development as taught in class.
They are intended for use with **Visual Studio**, the **ASP.NET framework**, and **Bootstrap 5.0** for layout and styling.
All AI-assisted code generation and team development must strictly adhere to these rules to ensure **consistency, simplicity, and maintainability**.

---

## ðŸ§© Rule 1: Database Structure and Connection Setup

### 1.1 Database Creation

* The database must be created **via an `.mdf` file** added directly to the project (e.g., `App_Data\wappDatabase.mdf`).
* **Default connection string** generated by Visual Studio must be used.
* No external SQL Server connections or object-oriented entity classes should be created manually.

### 1.2 Restrictions

* **Do not** create `.cs` model classes (e.g., `User.cs`, `Product.cs`) to represent tables.
* **Do not** use Entity Framework or LINQ-to-SQL ORM techniques.
* All data operations must use **`SqlConnection`, `SqlCommand`, and SqlDataSource`** from ASP.NET.

### 1.3 Connection Pattern

All manual connections (for login or special operations) must follow the 6-step pattern:

```csharp
// Step 1: Import namespaces
using System.Configuration;
using System.Data.SqlClient;

// Step 2: Create connection
string connStr = ConfigurationManager.ConnectionStrings["wappConnectionString1"].ConnectionString;
SqlConnection conn = new SqlConnection(connStr);

try
{
    // Step 3: Open connection
    conn.Open();

    // Step 4: Prepare SqlCommand
    string query = "SELECT * FROM tblCustomers WHERE email = @email AND password = @password";
    SqlCommand comm = new SqlCommand(query, conn);
    comm.Parameters.AddWithValue("@email", txtEmail.Text.Trim());
    comm.Parameters.AddWithValue("@password", txtPass.Text);

    // Step 5: Execute reader or scalar
    SqlDataReader reader = comm.ExecuteReader();
    if (reader.Read())
    {
        // Example Session usage
        Session["CID"] = reader["cid"].ToString();
        Response.Redirect("Default.aspx");
    }
}
finally
{
    // Step 6: Close connection
    if (conn.State == System.Data.ConnectionState.Open)
        conn.Close();
}
```

### 1.4 Database Schema Reference

* The database schema used by all pages must match the structure defined in
  `App_Data/schema.sql`.
* This file serves as the **single source of truth** for table names, columns, and data types.

---

## ðŸ§© Rule 2: Toolbox-Only Components

### 2.1 Component Policy

* **All UI elements must come from the ASP.NET Toolbox** provided in Visual Studio.
* This includes (but is not limited to):
  `Button`, `TextBox`, `Label`, `DropDownList`, `RadioButtonList`, `SqlDataSource`, `FileUpload`, `GridView`, and `RequiredFieldValidator`.

### 2.2 Restrictions

* Do **not** create input controls using HTML tags (`<input>`, `<select>`, etc.).
* Do **not** use third-party libraries, JavaScript frameworks, or external widgets.

### 2.3 Example

```aspx
<asp:Button ID="btnLogin" runat="server" Text="Login" OnClick="btnLogin_Click" />
<asp:TextBox ID="txtEmail" runat="server"></asp:TextBox>
<asp:SqlDataSource ID="SqlDataSource1" runat="server" ... />
```

---

## ðŸ§© Rule 3: SqlDataSource Enforcement

### 3.1 Usage

When inserting, updating, or deleting data, the `.aspx` file must include an **`<asp:SqlDataSource>`** element configured directly with:

* `InsertCommand`
* `UpdateCommand`
* `DeleteCommand`
* `SelectCommand`

### 3.2 Parameterization

Parameters must be properly declared and linked with Control IDs:

```aspx
<asp:SqlDataSource ID="SqlDataSource1" runat="server"
    ConnectionString="<%$ ConnectionStrings:wappConnectionString1 %>"
    InsertCommand="INSERT INTO [tblCustomers] ([firstName], [lastName]) VALUES (@firstName, @lastName)">
    <InsertParameters>
        <asp:ControlParameter ControlID="txtFirstName" Name="firstName" PropertyName="Text" Type="String" />
        <asp:ControlParameter ControlID="txtLastName" Name="lastName" PropertyName="Text" Type="String" />
    </InsertParameters>
</asp:SqlDataSource>
```

### 3.3 Backend Trigger

All CRUD actions must be triggered from the backend using event-driven methods:

```csharp
protected void btnAdd_Click(object sender, EventArgs e)
{
    SqlDataSource1.Insert();
}
```

---

## ðŸ§© Rule 4: Naming Conventions

### 4.1 Control Prefixes

| Control Type        | Prefix | Example ID         |
| ------------------- | ------ | ------------------ |
| **Button**          | `btn`  | `btnRegister`      |
| **TextBox**         | `txt`  | `txtEmail`         |
| **Label**           | `lbl`  | `lblStatus`        |
| **DropDownList**    | `ddl`  | `ddlCountry`       |
| **RadioButtonList** | `rdol` | `rdolGender`       |
| **FileUpload**      | `fu`   | `fuProfilePicture` |

### 4.2 Guidelines

* IDs must describe purpose (e.g., `btnSubmit`, not `Button1`).
* Apply this naming scheme **consistently across all `.aspx` pages and user controls**.

---

## ðŸ§© Rule 5: Styling and UI Design

### 5.1 Styling Policy

* **Only use Bootstrap 5.0** (the version included in ASP.NET templates).
* **Do not** create or link external CSS or JS files.
* **Do not** use inline styles, color customization, or external themes.

### 5.2 Layout Requirements

* Layout must remain simple and class-based, e.g.:

  ```html
  <table class="table">
      <tr>
          <td><asp:Label ID="lblName" runat="server" Text="Name:" /></td>
          <td><asp:TextBox ID="txtName" runat="server" CssClass="form-control" /></td>
      </tr>
  </table>
  ```
* The **header** design (from the Master Page) must never be altered.
* Focus on **functionality**, **clarity**, and **consistency**.

---

## ðŸ§© Rule 6: CRUD Page Pattern (Add, Update, Delete, View)

### 6.1 Overview

Every table must have its own **management Web Form** (e.g., `manageMovie.aspx`, `manageCustomer.aspx`).

### 6.2 Components

* Input controls for data entry.
* Buttons: Add (`btnAdd`), Update (`btnUpdate`), Delete (`btnDelete`).
* **SqlDataSource**: defines all CRUD operations.
* **GridView**: displays table contents with selection and paging enabled.

### 6.3 GridView Setup

```aspx
<asp:GridView ID="GridView1" runat="server"
    DataSourceID="SqlDataSource1"
    DataKeyNames="MID"
    AllowPaging="True" AllowSorting="True"
    OnSelectedIndexChanged="GridView1_SelectedIndexChanged">
    <Columns>
        <asp:CommandField ShowSelectButton="True" />
        <asp:BoundField DataField="MID" HeaderText="MID" ReadOnly="True" />
        <asp:BoundField DataField="title" HeaderText="Title" />
        <asp:ImageField DataImageUrlField="picture" HeaderText="Picture">
            <ControlStyle Width="50px" Height="50px" />
        </asp:ImageField>
    </Columns>
</asp:GridView>
```

### 6.4 Code-Behind Logic

* Use **Session variables** for selected row IDs.
* Always validate uploaded files and delete replaced images.
* All operations must be called through the corresponding `SqlDataSource`:

  * `SqlDataSource1.Insert();`
  * `SqlDataSource1.Update();`
  * `SqlDataSource1.Delete();`

### 6.5 Example Summary Table

| Operation  | Trigger Function                   | SqlDataSource Method | Notes                        |
| ---------- | ---------------------------------- | -------------------- | ---------------------------- |
| **Add**    | `btnAdd_Click()`                   | `.Insert()`          | Validate image, save file    |
| **Update** | `btnUpdate_Click()`                | `.Update()`          | Delete old image if replaced |
| **Delete** | `btnDelete_Click()`                | `.Delete()`          | Remove record by session ID  |
| **Select** | `GridView1_SelectedIndexChanged()` | â€”                    | Populate input fields        |

---

## ðŸ“˜ General Notes

* Always close database connections.
* Use `try...finally` blocks for any manual connection.
* Avoid global/static variables.
* Redirect users to the appropriate page after each successful CRUD operation.
* Maintain clear, consistent comments explaining each function.

---

**End of Cline Rules**
